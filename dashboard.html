<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Botnet C&C Dashboard</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000000;
            color: #00ff00;
            font-family: 'Share Tech Mono', monospace;
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
        }
        
        /* Matrix Rain Effect */
        #matrix-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
        }
        
        /* Header */
        .header {
            background: linear-gradient(45deg, #001100, #003300);
            border-bottom: 2px solid #00ff00;
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 20px #00ff00;
        }
        
        .header h1 {
            font-family: 'Orbitron', monospace;
            font-size: 2.5rem;
            font-weight: 900;
            text-shadow: 0 0 20px #00ff00;
            animation: pulse 2s infinite;
        }
        
        .header .subtitle {
            font-size: 1.2rem;
            color: #00cccc;
            margin-top: 10px;
            text-shadow: 0 0 10px #00cccc;
        }
        
        /* Main Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Cards */
        .card {
            background: linear-gradient(135deg, #001100, #002200);
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 40px rgba(0, 255, 0, 0.5);
            border-color: #00ffff;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 0, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .card:hover::before {
            left: 100%;
        }
        
        .card-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: #00ffff;
            margin-bottom: 15px;
            text-shadow: 0 0 10px #00ffff;
            border-bottom: 1px solid #00ff00;
            padding-bottom: 10px;
        }
        
        .stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 8px 0;
            border-bottom: 1px dotted #004400;
        }
        
        .stat-label {
            color: #00cccc;
            font-weight: bold;
        }
        
        .stat-value {
            color: #00ff00;
            font-weight: bold;
            text-shadow: 0 0 5px #00ff00;
        }
        
        .stat-value.critical {
            color: #ff0066;
            text-shadow: 0 0 5px #ff0066;
            animation: blink 1s infinite;
        }
        
        .stat-value.warning {
            color: #ffff00;
            text-shadow: 0 0 5px #ffff00;
        }
        
        /* Progress Bars */
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #001100;
            border: 1px solid #00ff00;
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #00ffff);
            box-shadow: 0 0 10px #00ff00;
            transition: width 0.5s ease;
        }
        
        /* Bot List */
        .bot-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .bot-item {
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #004400;
            border-radius: 5px;
            padding: 10px;
            margin: 5px 0;
            transition: all 0.3s ease;
        }
        
        .bot-item:hover {
            background: rgba(0, 255, 0, 0.2);
            border-color: #00ff00;
        }
        
        .bot-id {
            color: #00ffff;
            font-weight: bold;
        }
        
        .bot-status {
            color: #00ff00;
            font-size: 0.9rem;
        }
        
        .bot-status.offline {
            color: #ff0066;
        }
        
        /* Command History */
        .command-history {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #004400;
            border-radius: 5px;
            padding: 10px;
        }
        
        .command-item {
            margin: 5px 0;
            padding: 5px;
            border-left: 2px solid #00ff00;
            padding-left: 10px;
        }
        
        .command-time {
            color: #666666;
            font-size: 0.8rem;
        }
        
        .command-text {
            color: #00ff00;
            margin: 2px 0;
        }
        
        /* Animations */
        @keyframes pulse {
            0%, 100% { text-shadow: 0 0 20px #00ff00; }
            50% { text-shadow: 0 0 40px #00ff00, 0 0 60px #00ff00; }
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.5; }
        }
        
        /* Status Indicators */
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse-dot 2s infinite;
        }
        
        .status-indicator.online {
            background: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }
        
        .status-indicator.offline {
            background: #ff0066;
            box-shadow: 0 0 10px #ff0066;
        }
        
        .status-indicator.warning {
            background: #ffff00;
            box-shadow: 0 0 10px #ffff00;
        }
        
        @keyframes pulse-dot {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 20px;
            border-top: 1px solid #004400;
            margin-top: 40px;
            color: #666666;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Matrix Rain Canvas -->
    <canvas id="matrix-canvas"></canvas>
    
    <!-- Header -->
    <div class="header">
        <h1>üõ°Ô∏è ENHANCED BOTNET C&C</h1>
        <div class="subtitle">Command & Control Dashboard - Educational Research Platform</div>
    </div>
    
    <!-- Main Dashboard -->
    <div class="dashboard">
        <!-- Server Status Card -->
        <div class="card">
            <div class="card-title">üñ•Ô∏è Server Status</div>
            <div class="stat">
                <span class="stat-label">Status:</span>
                <span class="stat-value" id="server-status">
                    <span class="status-indicator online"></span>ONLINE
                </span>
            </div>
            <div class="stat">
                <span class="stat-label">Uptime:</span>
                <span class="stat-value" id="uptime">--</span>
            </div>
            <div class="stat">
                <span class="stat-label">Version:</span>
                <span class="stat-value" id="version">2.0 Enhanced</span>
            </div>
            <div class="stat">
                <span class="stat-label">Encryption:</span>
                <span class="stat-value" id="encryption-status">AES-256-CBC</span>
            </div>
            <div class="stat">
                <span class="stat-label">TLS:</span>
                <span class="stat-value" id="tls-status">--</span>
            </div>
        </div>
        
        <!-- Bot Statistics Card -->
        <div class="card">
            <div class="card-title">ü§ñ Bot Network</div>
            <div class="stat">
                <span class="stat-label">Active Bots:</span>
                <span class="stat-value" id="active-bots">0</span>
            </div>
            <div class="stat">
                <span class="stat-label">Total Connections:</span>
                <span class="stat-value" id="total-connections">0</span>
            </div>
            <div class="stat">
                <span class="stat-label">Commands Processed:</span>
                <span class="stat-value" id="commands-processed">0</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="connection-progress" style="width: 0%"></div>
            </div>
            <small style="color: #666;">Connection Utilization</small>
        </div>
        
        <!-- Performance Metrics Card -->
        <div class="card">
            <div class="card-title">üìä Performance</div>
            <div class="stat">
                <span class="stat-label">Bytes Sent:</span>
                <span class="stat-value" id="bytes-sent">0 B</span>
            </div>
            <div class="stat">
                <span class="stat-label">Bytes Received:</span>
                <span class="stat-value" id="bytes-received">0 B</span>
            </div>
            <div class="stat">
                <span class="stat-label">Data Rate:</span>
                <span class="stat-value" id="data-rate">0 KB/s</span>
            </div>
            <div class="stat">
                <span class="stat-label">Memory Usage:</span>
                <span class="stat-value" id="memory-usage">--</span>
            </div>
        </div>
        
        <!-- Active Bots Card -->
        <div class="card">
            <div class="card-title">üåê Active Bots</div>
            <div class="bot-list" id="bot-list">
                <div style="text-align: center; color: #666; padding: 20px;">
                    No active bots connected
                </div>
            </div>
        </div>
        
        <!-- Security Status Card -->
        <div class="card">
            <div class="card-title">üîí Security</div>
            <div class="stat">
                <span class="stat-label">Auth Status:</span>
                <span class="stat-value" id="auth-status">--</span>
            </div>
            <div class="stat">
                <span class="stat-label">Failed Attempts:</span>
                <span class="stat-value warning" id="failed-attempts">0</span>
            </div>
            <div class="stat">
                <span class="stat-label">Blocked IPs:</span>
                <span class="stat-value" id="blocked-ips">0</span>
            </div>
            <div class="stat">
                <span class="stat-label">Threat Level:</span>
                <span class="stat-value" id="threat-level">LOW</span>
            </div>
        </div>

        <!-- Recent Commands Card -->
        <div class="card">
            <div class="card-title">üìù Command History</div>
            <div class="command-history" id="command-history">
                <div style="text-align: center; color: #666; padding: 20px;">
                    No recent commands
                </div>
            </div>
        </div>

        <!-- CyberEditor Card -->
        <div class="card">
            <div class="card-title">üß† CyberEditor (AI Assisted)</div>
            <div class="stat">
                <span class="stat-label">Language:</span>
                <select id="editor-language" style="background: #001100; color: #00ff00; border: 1px solid #004400; padding: 6px; border-radius: 6px; width: 100%;">
                </select>
            </div>
            <div class="stat">
                <span class="stat-label">Supported Versions:</span>
                <span class="stat-value" id="editor-language-versions">--</span>
            </div>
            <div style="margin-top: 10px;">
                <textarea id="cyber-editor" style="width: 100%; height: 160px; background: #000; color: #00ff00; border: 1px solid #004400; border-radius: 6px; padding: 10px; font-family: 'Share Tech Mono', monospace;" placeholder="Write code with AI assistance..."></textarea>
            </div>
            <small style="color: #666;">Languages synced with DocuHub (DevDocs) - latest stable + previous 2-3 versions.</small>
        </div>
    </div>
    
    <!-- Footer -->
    <div class="footer">
        üéì Educational Research Platform | Enhanced Botnet Implementation v2.0<br>
        <small>For cybersecurity education and research purposes only</small>
    </div>
    
    <script>
        // Matrix Rain Effect
        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const matrix = "ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789@#$%^&*()*&^%+-/~{[|`]}";
        const matrixArray = matrix.split("");
        
        const fontSize = 10;
        const columns = canvas.width / fontSize;
        
        const drops = [];
        for(let x = 0; x < columns; x++) {
            drops[x] = 1; 
        }
        
        function drawMatrix() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.04)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#00ff00';
            ctx.font = fontSize + 'px monospace';
            
            for(let i = 0; i < drops.length; i++) {
                const text = matrixArray[Math.floor(Math.random() * matrixArray.length)];
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                
                if(drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
                drops[i]++;
            }
        }
        
        setInterval(drawMatrix, 35);
        
        // Resize canvas on window resize
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
        
        // Dashboard Data Management
        let dashboardData = {
            serverStatus: 'ONLINE',
            uptime: 0,
            activeBots: 0,
            totalConnections: 0,
            commandsProcessed: 0,
            bytesSent: 0,
            bytesReceived: 0,
            authStatus: 'AUTHENTICATED',
            tlsEnabled: false,
            bots: [],
            commandHistory: []
        };
        
        // Utility Functions
        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function formatUptime(seconds) {
            const days = Math.floor(seconds / 86400);
            const hours = Math.floor((seconds % 86400) / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = Math.floor(seconds % 60);
            
            if (days > 0) {
                return `${days}d ${hours}h ${minutes}m`;
            } else if (hours > 0) {
                return `${hours}h ${minutes}m ${secs}s`;
            } else {
                return `${minutes}m ${secs}s`;
            }
        }
        
        // Update Dashboard UI
        function updateDashboard() {
            // Server Status
            document.getElementById('uptime').textContent = formatUptime(dashboardData.uptime);
            document.getElementById('tls-status').textContent = dashboardData.tlsEnabled ? 'ENABLED' : 'DISABLED';
            document.getElementById('auth-status').textContent = dashboardData.authStatus;
            
            // Bot Statistics
            document.getElementById('active-bots').textContent = dashboardData.activeBots;
            document.getElementById('total-connections').textContent = dashboardData.totalConnections;
            document.getElementById('commands-processed').textContent = dashboardData.commandsProcessed;
            
            // Connection utilization progress bar
            const utilization = Math.min((dashboardData.totalConnections / 100) * 100, 100);
            document.getElementById('connection-progress').style.width = utilization + '%';
            
            // Performance
            document.getElementById('bytes-sent').textContent = formatBytes(dashboardData.bytesSent);
            document.getElementById('bytes-received').textContent = formatBytes(dashboardData.bytesReceived);
            
            // Update bot list
            updateBotList();
            
            // Update command history
            updateCommandHistory();
        }
        
        function updateBotList() {
            const botList = document.getElementById('bot-list');
            
            if (dashboardData.bots.length === 0) {
                botList.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">No active bots connected</div>';
                return;
            }
            
            let html = '';
            dashboardData.bots.forEach(bot => {
                html += `
                    <div class="bot-item">
                        <div class="bot-id">ü§ñ ${bot.id}</div>
                        <div class="bot-status">üìç ${bot.ip} | ‚è∞ ${bot.lastSeen}</div>
                        <div class="bot-status">üìä ${bot.commandsSent} sent, ${bot.commandsCompleted} completed</div>
                    </div>
                `;
            });
            botList.innerHTML = html;
        }
        
        function updateCommandHistory() {
            const commandHistory = document.getElementById('command-history');
            
            if (dashboardData.commandHistory.length === 0) {
                commandHistory.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">No recent commands</div>';
                return;
            }
            
            let html = '';
            dashboardData.commandHistory.slice(-10).reverse().forEach(cmd => {
                html += `
                    <div class="command-item">
                        <div class="command-time">${cmd.timestamp}</div>
                        <div class="command-text">ü§ñ ${cmd.botId}: ${cmd.command}</div>
                    </div>
                `;
            });
            commandHistory.innerHTML = html;
        }
        
        // Fetch data from server
        async function fetchServerData() {
            try {
                const response = await fetch('/api/status');
                if (response.ok) {
                    const data = await response.json();
                    
                    // Update dashboard data
                    dashboardData.activeBots = data.active_bots || 0;
                    dashboardData.totalConnections = data.total_connections || 0;
                    dashboardData.commandsProcessed = data.commands_processed || 0;
                    dashboardData.bytesSent = data.bytes_sent || 0;
                    dashboardData.bytesReceived = data.bytes_received || 0;
                    dashboardData.uptime = data.uptime_seconds || 0;
                    dashboardData.tlsEnabled = data.tls_enabled || false;
                    dashboardData.authStatus = data.admin_authenticated ? 'AUTHENTICATED' : 'NOT AUTHENTICATED';
                    
                    // Update bots if available
                    if (data.bots) {
                        dashboardData.bots = Object.values(data.bots).map(bot => ({
                            id: bot.id,
                            ip: bot.ip,
                            lastSeen: new Date(bot.last_seen).toLocaleTimeString(),
                            commandsSent: bot.commands_sent,
                            commandsCompleted: bot.commands_completed
                        }));
                    }
                    
                    // Update command history if available
                    if (data.command_history) {
                        dashboardData.commandHistory = data.command_history.map(cmd => ({
                            timestamp: new Date(cmd.timestamp).toLocaleTimeString(),
                            botId: cmd.bot_id,
                            command: cmd.command
                        }));
                    }
                    
                    updateDashboard();
                } else {
                    // Simulate some demo data if server not available
                    simulateDemoData();
                }
            } catch (error) {
                console.log('Server not available, using demo data');
                simulateDemoData();
            }
        }
        
        // Simulate demo data for display
        function simulateDemoData() {
            dashboardData.uptime += 1;
            dashboardData.activeBots = Math.floor(Math.random() * 5) + 1;
            dashboardData.totalConnections = dashboardData.activeBots + Math.floor(Math.random() * 3);
            dashboardData.commandsProcessed += Math.floor(Math.random() * 3);
            dashboardData.bytesSent += Math.floor(Math.random() * 1024);
            dashboardData.bytesReceived += Math.floor(Math.random() * 512);
            
            // Simulate some bots
            dashboardData.bots = [];
            for (let i = 0; i < dashboardData.activeBots; i++) {
                dashboardData.bots.push({
                    id: `bot_${Math.random().toString(16).slice(2, 8)}`,
                    ip: `192.168.1.${100 + i}`,
                    lastSeen: new Date().toLocaleTimeString(),
                    commandsSent: Math.floor(Math.random() * 10),
                    commandsCompleted: Math.floor(Math.random() * 8)
                });
            }
            
            // Add occasional command to history
            if (Math.random() > 0.7) {
                dashboardData.commandHistory.push({
                    timestamp: new Date().toLocaleTimeString(),
                    botId: `bot_${Math.random().toString(16).slice(2, 6)}`,
                    command: ['!status', '!system_info', '!network_config'][Math.floor(Math.random() * 3)]
                });
            }
            
            updateDashboard();
        }
        
        // Initialize dashboard
        updateDashboard();
        
        // Fetch data every 2 seconds
        setInterval(fetchServerData, 2000);
        
        // Initial fetch
        fetchServerData();

        // CyberEditor language support (DocuHub/DevDocs aligned)
        const fallbackEditorLanguages = [
            { id: "javascript", label: "JavaScript", versions: ["ES2024", "ES2023", "ES2022"] },
            { id: "typescript", label: "TypeScript", versions: ["5.6", "5.5", "5.4"] },
            { id: "python", label: "Python", versions: ["3.12", "3.11", "3.10"] },
            { id: "go", label: "Go", versions: ["1.23", "1.22", "1.21"] },
            { id: "rust", label: "Rust", versions: ["1.82", "1.81", "1.80"] },
            { id: "java", label: "Java", versions: ["22", "21", "17"] },
            { id: "kotlin", label: "Kotlin", versions: ["2.0", "1.9", "1.8"] },
            { id: "swift", label: "Swift", versions: ["5.10", "5.9", "5.8"] },
            { id: "csharp", label: "C#", versions: ["12", "11", "10"] },
            { id: "cpp", label: "C++", versions: ["C++23", "C++20", "C++17"] },
            { id: "c", label: "C", versions: ["C18", "C11", "C99"] },
            { id: "php", label: "PHP", versions: ["8.3", "8.2", "8.1"] },
            { id: "ruby", label: "Ruby", versions: ["3.3", "3.2", "3.1"] },
            { id: "scala", label: "Scala", versions: ["3.4", "2.13", "2.12"] },
            { id: "elixir", label: "Elixir", versions: ["1.17", "1.16", "1.15"] },
            { id: "erlang", label: "Erlang", versions: ["27", "26", "25"] },
            { id: "haskell", label: "Haskell", versions: ["9.10", "9.8", "9.6"] },
            { id: "r", label: "R", versions: ["4.4", "4.3", "4.2"] },
            { id: "dart", label: "Dart", versions: ["3.4", "3.3", "3.2"] },
            { id: "lua", label: "Lua", versions: ["5.4", "5.3", "5.2"] },
            { id: "clojure", label: "Clojure", versions: ["1.12", "1.11", "1.10"] },
            { id: "perl", label: "Perl", versions: ["5.40", "5.38", "5.36"] },
            { id: "sql", label: "SQL", versions: ["PostgreSQL 17", "PostgreSQL 16", "MySQL 8.0"] },
            { id: "bash", label: "Bash", versions: ["5.2", "5.1", "5.0"] },
            { id: "powershell", label: "PowerShell", versions: ["7.4", "7.3", "7.2"] },
            { id: "html", label: "HTML", versions: ["HTML5"] },
            { id: "css", label: "CSS", versions: ["CSS4", "CSS3"] },
            { id: "json", label: "JSON", versions: ["1.0"] },
            { id: "yaml", label: "YAML", versions: ["1.3", "1.2", "1.1"] },
            { id: "markdown", label: "Markdown", versions: ["GFM"] },
        ];

        function updateEditorVersionDisplay(langId, languages) {
            const infoEl = document.getElementById('editor-language-versions');
            const match = languages.find((l) => l.id === langId);
            infoEl.textContent = match ? match.versions.join(', ') : '--';
        }

        function populateEditorLanguages(languages) {
            const select = document.getElementById('editor-language');
            select.innerHTML = '';
            languages.forEach((lang) => {
                const opt = document.createElement('option');
                opt.value = lang.id;
                opt.textContent = lang.label;
                select.appendChild(opt);
            });
            if (languages.length > 0) {
                select.value = languages[0].id;
                updateEditorVersionDisplay(select.value, languages);
            }
            select.addEventListener('change', () => updateEditorVersionDisplay(select.value, languages));
        }

        async function loadEditorLanguages() {
            try {
                const response = await fetch('/api/editor/languages');
                if (!response.ok) {
                    throw new Error('Language endpoint unavailable');
                }
                const data = await response.json();
                populateEditorLanguages(data.languages || fallbackEditorLanguages);
            } catch (err) {
                console.warn('Falling back to embedded language list', err);
                populateEditorLanguages(fallbackEditorLanguages);
            }
        }

        loadEditorLanguages();
    </script>
</body>
</html>
